<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>3facs</title>
<style>
body{
  background:#0b0b0b;
  color:#eaeaea;
  font-family:monospace;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}
#box{width:600px}
textarea{
  width:100%;
  height:140px;
  background:#111;
  color:#0f0;
  border:1px solid #333;
  padding:10px;
  box-sizing:border-box;
}
button{
  width:49%;
  margin-top:10px;
  background:#222;
  color:#fff;
  border:1px solid #444;
  padding:10px;
  cursor:pointer;
}
button:hover{background:#333}
</style>
</head>
<body>
<div id="box">
  <textarea id="input" placeholder="input"></textarea>
  <textarea id="output" placeholder="output"></textarea>
  <button onclick="encode()">encode</button>
  <button onclick="decode()">decode</button>
</div>

<script>
// shift cipher
function caesar(str, shift){
  return str.split("").map(c=>{
    let n=c.charCodeAt(0);
    if(n>=32 && n<=126){
      return String.fromCharCode(((n-32+shift)%95+95)%95+32);
    }
    return c;
  }).join("");
}

// binary morse (lossless)
function toMorse(str){
  return [...str].map(c=>{
    return c.charCodeAt(0)
      .toString(2)
      .padStart(8,"0")
      .replace(/0/g,".")
      .replace(/1/g,"-");
  }).join(" / ");
}

function fromMorse(str){
  return str.split(" / ").map(bits=>{
    let bin = bits.replace(/\./g,"0").replace(/-/g,"1");
    return String.fromCharCode(parseInt(bin,2));
  }).join("");
}

// opposite order:
// morse -> base64 -> shift+7
function encode(){
  let t = document.getElementById("input").value;
  t = toMorse(t);
  t = btoa(t);
  t = caesar(t,7);
  document.getElementById("output").value = t;
}

// reverse:
// shift-7 -> base64 -> morse
function decode(){
  let t = document.getElementById("input").value;
  t = caesar(t,-7);
  t = atob(t);
  t = fromMorse(t);
  document.getElementById("output").value = t;
}
</script>
</body>
</html>
